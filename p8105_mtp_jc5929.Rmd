---
title: "p8105_mtp_jc5929"
output: github_document
date: "2022-10-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(dplyr)
library(knitr)
library(readxl)
library(ggridges)
library(patchwork)
```
**Introduction and goal of the project**

This raw data set of dog_data contains the weight of three dogs Raisin, 
Simona and Gagne in 4 years.This project aims to analyze the weight of the three
dogs from 2018 to 2022.

**Cleaning data set**
```{r}
dog_data= read_excel("data/dogweights_07may2022.xlsx",skip = 1,col_types = 
                   c("date", "guess", "guess", "guess", "guess", "text")) %>% 
  janitor::clean_names() %>% 
  drop_na(date) %>% 
  subset(raisin != "NA" | simone != "NA" | gagne != "NA") %>% 
  select(-x6) %>% 
  separate(date,into=c("year","month","day"),sep="-") %>% 
  separate(raisin,into=c("lbs","oz"),sep=2)%>%
  mutate(lbs=as.numeric(lbs), oz=as.numeric(oz)) %>%
  mutate(raisin=round((lbs+oz/16),2))%>%
  select(-lbs,-oz) %>%
  separate(simone, into=c("lbs","oz"),sep=2) %>%
  mutate(lbs=as.numeric(lbs), oz=as.numeric(oz)) %>%
  mutate(simone=round((lbs+oz/16),2))%>%
  select(-lbs,-oz) %>%
  separate(gagne, into=c("lbs","oz"),sep=2) %>%
  mutate(lbs=as.numeric(lbs), oz=as.numeric(oz)) %>%
  mutate(gagne=round((lbs+oz/16),2)) %>%
  select(-lbs,-oz) %>% 
  separate(std, into=c("lbs","oz"),sep=2) %>%
  mutate(lbs=as.numeric(lbs), oz=as.numeric(oz)) %>%
  mutate(std=round((lbs+oz/16),2)) %>%
  select(-lbs,-oz) %>% 
  pivot_longer(
    raisin:gagne,
    names_to = "dog_name",
    values_to = "weight"
  )                  %>%
  drop_na(weight) %>%
  relocate(std,.after=weight)

```
The raw data was in excel format and the “Date” variable has multiple forms of expressions. After importing, I unified them into 
a single format. Then I dropped the row that has no date information, I also dropped the rows that has NA in all three dogs'
weight, as this kind of data will be useless for our further analysis. 

Next, I tried to format the weight into a reasonable unit. I have separated the columns raisin, simone, and gagne by whitespace, 
respectively, into two columns pounds and oz. And then convert the weight unit to pounds, this step was made by dividing the oz by 16, and add it with the pounds column. This whole step was done three times for the three dogs. 

Realizing that the original data was in a wide format where all three dogs’ names are the column names, which is not tidy enough. I make it into a long format by replacing the three dogs's names into two columns, dog_name and weight. I also deleted the rows that has NA in the weight column. Finally, I rearrange the column sequence in order for a better view.

This next step is to create a second data frame containing notes and the date they entered in, and save the two data frames I made into csv files.
**Creating a data frame with notes**
```{r}
notes_df= read_excel("data/dogweights_07may2022.xlsx", skip = 1, col_types = 
                    c("date", "guess", "guess", "guess", "guess", "text")) %>% 
  janitor::clean_names() %>% 
  mutate(notes = x6) %>%
  drop_na(notes) %>%
  select(date,notes) %>%
  select(date, notes) %>% 
  separate(date, into=c("year", "month", "day"),sep="-")
  
```

**Export data sets**
```{r}
write_csv(dog_data, "data/dog.csv")
write_csv(notes_df, "data/notes.csv")
```

*Summary of the data set**
```{r}
 dog_data%>%
   distinct(year,month,day)
```
In the tidy data set dog_data, it contains `r nrow(dog_data)` rows, and `r ncol(dog_data)` columns. The rows represents the weight 
informartion for a single dog on a specific date. The columns includes variables of the data date, dog name, weight, and the weight of a standard object. There are 356 unique dates included. Below is a table showing the number of observations for each dog, along with their average weight and standard deviation.
```{r}
dog_data%>%
  group_by(dog_name) %>%
  summarize(obs=n(),
            avg_weight=mean(weight),
            sd_weight=sd(weight)) %>%
knitr::kable()

```
From this table, Simone has a relatively lower weight compared to Raisin and Gagne. Raisin has the highest standard deviation, it is
interesting to note that Raisin was recorded to have a weight of 7.94 pounds on August 14th in 2019. This number was way lower than
Raisin's average weight. Gagne has a relatively stable weight than Simone and Raisin. 
**Visualization**

```{r}
plot1=dog_data %>%
  group_by(dog_name,weight) %>%
  ggplot(aes(x=weight,y=dog_name,fill=dog_name))+
  geom_density_ridges(
    aes(point_color = dog_name, point_shape = dog_name,point_fill=dog_name),
    alpha = .3, point_alpha = 0.7, jittered_points = TRUE
  ) +labs(title = "The distribution of weights for each dog",
    x = "weight",
    y = "density")


dog_df1= dog_data%>%
  mutate(date=as.Date(with(dog_data,paste(year,month,day,sep="-"),"%Y-%m-%d")))%>%
  select(-year,-month,-day) 
 
plot2= dog_df1 %>%
  group_by(dog_name,weight) %>%
  ggplot(aes(x=date,y=weight,color=dog_name))+geom_point(alpha=0.4)+ 
  geom_smooth(alpha=0.4, se=FALSE) +labs(title = "Weight distrubution over time",
       x = "date",
       y = "weight")+scale_x_date(date_labels = "%b-%d-%Y")+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
                                        
  
plot1+plot2




```
The plot on the left shows the density of weight for each dog, we can find that Raisin has much higher weight than Gagne and Simon. From the plot,we can also see that there exits an outlier for Raisin that has a weight of less than 10 pounds. 

Observing the weight for each dog over time, we can see that the trend for Simone gradually decreased from 2018 to 2020, and then started
to decrease rapidly until 2022. Raisin has a decreasing trend overall as well, but Raisin has slightly increased in its weight between July 2019 and July 2020, and also between July 2021 and May 2022. However, Raisin's weight is still relatively lower in 2022 compared to its original weight in 2018. Weight for Raisin also appears to have a big fluctuation over the time. For Gagne, its weight kept going down rapidly, especially after April 2019, and shows to have the lowest weight among the three dogs. After September 2019, there is no records for Gagne anymore. 
